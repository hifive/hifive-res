/* Copyright (C) 2013-2018 NS Solutions Corporation. Licensed under the Apache License, Version 2.0. hifive Developer Tool ver.1.0.8 gitCommitId 6541489a88520a488162532445c6c050282553dc */(function(e){function ba(a){return null==a?a:e.isArray(a)?a:[a]}function O(a){h5.settings.aspects=e.map(ba(a),function(a){a.target&&(a.compiledTarget=F(a.target));a.pointCut&&(a.compiledPointCut=F(a.pointCut));return a})}function F(a){if("regexp"===e.type(a))return a;var b="",b=-1!==a.indexOf("*")?e.map(a.split("*"),function(a){return a.replace(/\W/g,"\\$&")}).join(".*"):a;return RegExp("^"+b+"$")}function G(){var a=h5.async.deferred(),b=null,c=null;if(B){var d="about:blank";if(h5.env.ua.isIE&&9>
h5.env.ua.browserVersion){if(!window.__h5_devtool_page)return P.error("IE8以下で使用する場合、window.__h5_devtool_pageにダミーページのパスを指定する必要があります。"),a.reject("no_dummy_page").promise();d=window.__h5_devtool_page}c=window.open(d,"__h5devtool__"+(new Date).getTime()+"_"+parseInt(1E3*Math.random()),"resizable=1, menubar=no, width=910, height=700, toolbar=no, scrollbars=yes");if(!c)return a.reject("block").promise();if(c._h5devtool)return c.close(),G();try{c.document}catch(g){return c.close(),G()}var k=function(){c._h5devtool=
!0;b=c.document.body;e(b).addClass("h5devtool");e(c.document.getElementsByTagName("html")).addClass("h5devtoolHTML");c.document.title=h5.u.str.format("[devtool]{0} - hifive Developer Tool ver.{1}",window.document.title,Q)};if(c.document&&"complete"===c.document.readyState)k(),a.resolve(c);else var f=null,f=setInterval(function(){c.document&&"complete"===c.document.readyState&&(clearInterval(f),k(),a.resolve(c))},100)}else c=window,b=document.body,h.append(b,"wrapper"),a.resolve(c);return a.promise()}
function R(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}function S(a,b,c){var d=a.document;if(!e(d).find("style.h5devtool-style").length||a==window){a=b;if(c)for(var g in c)h5.env.ua[g]&&(a=a.concat(c[g]));c=d.createElement("style");e(c).addClass("h5devtool-style");d.getElementsByTagName("head")[0].appendChild(c);d=d.styleSheets[d.styleSheets.length-1];if(d.insertRule)for(c=0,b=a.length;c<b;c++){var k=a[c],f=k.selector,k=k.rule,f=f+"{";for(g in k){var l=R(g),p=k[g];if(e.isArray(p))for(var m=
0,h=p.length;m<h;m++)f+=l+":"+p[m]+";";else f+=l+":"+p+";"}f+="}";d.insertRule(f,d.cssRules.length)}else{var ca=!h5.env.ua.isIE||7<h5.env.ua.browserVersion;c=0;for(b=a.length;c<b;c++)for(g in k=a[c],f=k.selector,k=k.rule,k)if(l=R(g),p=k[g],ca)d.addRule(f,l+":"+p);else for(var n=f.split(","),m=0,h=n.length;m<h;m++)if(e.isArray(p))for(var q=0,h=p.length;q<h;q++)d.addRule(n[m],l+":"+p[q]);else d.addRule(n[m],l+":"+p)}}}function I(a){if(!a)return""+a;if(a===J)return"関数の中身を表示できません";a=a.toString();var b=
a.match(/(\t+)\}$/);return(b=b&&b[1])?a.replace(RegExp("\n"+b,"g"),"\n"):a}function T(a){if(a===window)return"window";if(9===a.nodeType)return"document";var b=a.id,c=a.className;return a.tagName.toLowerCase()+(b&&"#"+b)+(c&&"."+c.replace(/\s/g,"."))}function U(a){var b=[],c;for(c in a){var d=a[c];h5.u.str.endsWith(c,"Controller")&&"rootController"!==c&&"parentController"!==c&&!e.isFunction(d)&&d&&!d.__controllerContext.isRoot&&b.push(c)}return b}function da(a,b){var c=e(b.rootElement),d=a.lastIndexOf(" "),
d=e.trim(a.substring(0,d));if(d.match(/^\{.*\}$/)){d=e.trim(d.substring(1,d.length-1));if("rootElement"===d)return c;a:for(var c=d,d=["window","document","navigator"],g=0,k=d.length;g<k;g++){var f=d[g];if(c===f){c=h5.u.obj.getByPath(c);break a}if(h5.u.str.startsWith(c,f+".")){c=h5.u.obj.getByPath(c);break a}}return e(c)}return c.find(d)}function C(a){function b(a,b){for(var c=b-(""+a).length,d=0;d<c;d++)a="0"+a;return a}var c=b(a.getHours(),2),d=b(a.getMinutes(),2),e=b(a.getSeconds(),2);a=b(a.getMilliseconds(),
3);return h5.u.str.format("{0}:{1}:{2}.{3}",c,d,e,a)}function K(a,b,c,d,e,k){var f=new Date;return{target:a,time:C(f),timeStamp:f.getTime(),cls:c,message:b,tag:d,promiseState:e,indentWidth:k*ea}}function v(a,b){a.push(b);a.length>w.get("LogMaxNum")&&a.shift();a.dispatchEvent({type:"logUpdate"})}function V(a,b){if(b.__controllerContext){b=e.extend(!0,{},b);for(var c in b)e.isFunction(b[c])&&b[c].toString()===W&&(b[c]=J)}a.__controllerContext.controllerDef=b;for(c in b)h5.u.str.endsWith(c,"Controller")&&
"rootController"!==c&&"parentController"!==c&&b[c]&&V(a[c],b[c])}function x(){var a=h5.core.data.createObservableArray();y.push(a);return a}function L(a){return s.getComputedStyle?s.getComputedStyle(e(a)[0],null):e(a)[0].currentStyle}function fa(a){if(X)return e(a).outerHeight();a=L(a);return parseInt(a.height)+parseInt(a.paddingTop)+parseInt(a.paddingBottom)+parseInt(a.borderTopWidth)+parseInt(a.borderBottomWidth)+parseInt(a.marginTop)+parseInt(a.marginBottom)}function ga(a){if(X)return e(a).outerWidth();
a=L(a);return parseInt(a.width)+parseInt(a.paddingLeft)+parseInt(a.paddingRight)+parseInt(a.borderLeftWidth)+parseInt(a.borderRightWidth)+parseInt(a.marginLeft)+parseInt(a.marginRight)}function ha(a){for(var b=e(a)[0];b&&"HTML"!==b.nodeName&&"static"===L(b).position;)b=b.offsetParent;return b||a.ownerDocument}function D(a,b){this._method={};this._callback=b;var c=a.__controllerContext?a.__controllerContext.controllerDef:a.__logicContext.logicDef,d;for(d in c)e.isFunction(c[d])&&(this._method[d]={count:0})}
function n(a){if(!a)return null;a=a.__controllerContext||a.__logicContext;a.devtool=a.devtool||{};return a.devtool}function ia(a){function b(a){c.addClass("blink");setTimeout(function(){c.removeClass("blink");a&&setTimeout(function(){b(--a)},100)},100)}var c=e(a);b(4)}function ja(a){delete z[a]}function Y(a,b,c){a.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,c)}function Z(a,b,c){var d=0,g=null;a.find("li").each(function(){if(e.trim(e(this).find(".name").text())===b)return d=this.offsetTop-
this.parentNode.offsetTop,g=this,!1});g&&(a.scrollTop(d),ia(g))}if(window.h5&&!h5.devtool){var B=!0,Q="1.0.8",ea=10,q=["__construct","__init","__ready","__unbind","__dispose"],$=[{selector:".h5devtool",rule:{backgroundColor:"rgba(255,255,255,0.8)",height:"100%",width:"100%",margin:0,padding:0,zIndex:2E4}},{selector:".h5devtoolHTML",rule:{height:"100%",width:"100%",margin:0,padding:0,overflow:"hidden"}},{selector:".h5devtool.posfix",rule:{position:"fixed",top:0,left:0}},{selector:".h5devtool .floating-list",
rule:{height:"100%",overflow:"auto",margin:0}},{selector:".h5devtool .devtool-tab",rule:{height:"100%"}},{selector:".h5devtool-upper-right",rule:{position:"fixed",zIndex:20001,top:0,left:"810px",width:"100px",textAlign:"right"}},{selector:".h5devtool .liststyle-none",rule:{listStyle:"none"}},{selector:".h5devtool .no-padding",rule:{padding:"0!important"}},{selector:".h5devtool .font-small",rule:{fontSize:"0.8em"}},{selector:".h5devtool .logline",rule:{paddingLeft:0,paddingTop:"4px",borderTop:"1px solid #eee",
borderBottom:"1px solid #eee",margin:0,color:"gray",whiteSpace:"nowrap",margin:"0 0 -1px 2px",fontSize:"12px",fontFamily:"'ＭＳ ゴシック','Osaka－等幅',sans-serif"}},{selector:".h5devtool .logline .time",rule:{marginRight:"1em",color:"gray",fontWeight:"normal"}},{selector:".h5devtool .fixedControlls",rule:{paddingLeft:0,margin:0,backgroundColor:"#fff",border:"solid 1px gray",padding:"3px","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box"}},{selector:".h5devtool .trace",
rule:{paddingBottom:"68px"}},{selector:".h5devtool .trace .lifecycleColor",rule:{color:"#15A2E3",borderColor:"#15A2E3"}},{selector:".h5devtool .trace .publicColor",rule:{color:"#31A120",borderColor:"#31A120"}},{selector:".h5devtool .trace .privateColor",rule:{color:"#4A370C",borderColor:"#4A370C"}},{selector:".h5devtool .trace .eventColor",rule:{color:"#861EC2",borderColor:"#861EC2"}},{selector:".h5devtool .trace .logColor",rule:{color:"#000",borderColor:"#000"}},{selector:".h5devtool .logLevelThreshold",
rule:{margin:0,padding:0,height:"17px"}},{selector:".h5devtool .trace .fixedControlls .filterLabel",rule:{margin:"0 2px 4px 0",borderWidth:"0 0 3px 0",borderStyle:"solid",display:"inline-block"}},{selector:".h5devtool .trace .fixedControlls",rule:{height:"66px"}},{selector:".h5devtool .trace-list .logline",rule:{color:"gray"}},{selector:".h5devtool .trace-list>li.selected",rule:{backgroundColor:"#ddd"}},{selector:".h5devtool .trace-list>li .tag",rule:{display:"inline-block",minWidth:"3em"}},{selector:".h5devtool .trace-list>li .promiseState",
rule:{display:"inline-block",marginRight:"0.5em"}},{selector:".h5devtool .logger",rule:{paddingBottom:"24px",overflow:"hidden"}},{selector:".h5devtool .logger .console",rule:{}},{selector:".h5devtool .logger .fixedControlls",rule:{height:"30px",borderWidth:"1px 0 1px 0"}},{selector:".h5devtool .logger .console",rule:{height:"100%",margin:0,whiteSpace:"nowrap",fontFamily:"'ＭＳ ゴシック', Osaka－等幅, sans-serif"}},{selector:".h5devtool .logger-log.TRACE",rule:{color:"#000000"}},{selector:".h5devtool .logger-log.DEBUG",
rule:{color:"#0000ff"}},{selector:".h5devtool .logger-log.INFO",rule:{color:"#000000"}},{selector:".h5devtool .logger-log.WARN",rule:{color:"#0000ff"}},{selector:".h5devtool .logger-log.ERROR",rule:{color:"#ff0000"}},{selector:".h5devtool .logger-log.EXCEPTION",rule:{color:"#ff0000",fontWeight:"bold"}},{selector:".h5devtool .columnLayoutWrapper",rule:{overflow:"hidden!important"}},{selector:".h5devtool .target-info .controll",rule:{paddingLeft:"30px"}},{selector:".h5devtool .target-info .instance-detail",
rule:{height:"100%"}},{selector:".h5devtool .target-info .targetlist",rule:{paddingTop:0,paddingLeft:"1.2em","*paddingLeft":0,"*position":"relative","*left":"-1.2em"}},{selector:".h5devtool .target-info .targetlist .target-name",rule:{cursor:"default"}},{selector:".h5devtool .target-info .targetlist .target-name.selected",rule:{background:"rgb(170,237,255)!important"}},{selector:".h5devtool .target-info .targetlist .target-name:hover",rule:{background:"rgb(220,247,254)"}},{selector:".h5devtool .eventHandler .fixedController",
rule:{height:"24px"}},{selector:".h5devtool .eventHandler",rule:{paddingBottom:"24px"}},{selector:".h5devtool .target-info .eventHandler ul",rule:{listStyle:"none",margin:0}},{selector:".h5devtool .target-info .eventHandler ul li .name",rule:{lineHeight:"28px"}},{selector:".h5devtool .target-info .eventHandler li.selected",rule:{background:"rgb(203,254,231)"}},{selector:".h5devtool .method .fixedController",rule:{height:"24px"}},{selector:".h5devtool .method",rule:{paddingBottom:"24px"}},{selector:".h5devtool .method-list",
rule:{listStyle:"none",margin:0,"*padding-right":"16px!important"}},{selector:".h5devtool .method-list .nocalled",rule:{background:"-webkit-gradient(linear, left top, right top, color-stop(0.95, #C3E0EF), color-stop(0.00, #F5FBFE)){-webkit-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%){-moz-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%);{-o-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%){-ms-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%){linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%)".split("{")}},
{selector:".h5devtool .method-list .called",rule:{background:"-webkit-gradient(linear, left top, right top, color-stop(0.95, #6EB7DB), color-stop(0.00, #C3E0EF)){-webkit-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%){-moz-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%);{-o-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%){-ms-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%){linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%)".split("{")}},{selector:".h5devtool .method-list .blink",rule:{background:"#FF9617"}},
{selector:".h5devtool .target-info .otherInfo ul",rule:{margin:0}},{selector:".h5devtool .target-info .otherInfo dt",rule:{fontWeight:"bold",margin:"5px 0 5px 5px"}},{selector:".h5devtool .method-list .count",rule:{"float":"right",fontWeight:"bold",fontSize:"30px",position:"relative",top:"16px",right:"10px",color:"#888"}},{selector:".h5devtool .method-list pre",rule:{margin:"0 0 10px",padding:"4px",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre",whiteSpace:"pre-wrap",background:"rgb(250,250,250)",
border:"1px solid rgb(213,213,213)","-webkit-border-radius":"4px","-moz-border-radius":"4px",borderRadius:"4px",fontFamily:'Monaco,Menlo,Consolas,"Courier New",monospace',fontSize:"12px"}},{selector:".h5devtool .target-info .detail",rule:{overflow:"auto"}},{selector:".h5devtool .ovfAuto",rule:{overflow:"auto"}},{selector:".h5devtool .ovfHidden",rule:{overflow:"hidden"}},{selector:".h5devtool .left",rule:{"float":"left",height:"100%",maxWidth:"350px",border:"1px solid #20B5FF","-moz-box-sizing":"border-box",
"-webkit-box-sizing":"border-box",boxSizing:"border-box","*position":"absolute","*height":"auto","*top":0,"*left":0,"*bottom":0,"*width":"350px"}},{selector:".h5devtool .right",rule:{height:"100%",border:"1px solid #20B5FF",borderLeft:"none","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box","*position":"absolute","*height":"auto","*width":"auto","*top":0,"*left":"350px","*right":0,"*bottom":0}},{selector:".h5devtool .eventHandler .menu",rule:{display:"none"}},
{selector:".h5devtool .eventHandler .menu>*",rule:{display:"inline-block"}},{selector:".h5devtool .eventHandler .selected .menu",rule:{display:"inline-block"}},{selector:".h5devtool ul.nav-tabs",rule:{listStyle:"none",width:"100%",margin:0,padding:0,"float":"left"}},{selector:".h5devtool ul.nav-tabs>li",rule:{"float":"left",padding:"3px",border:"1px solid #ccc",color:"#20B5FF",marginLeft:"-1px",cursor:"pointer"}},{selector:".h5devtool ul.nav-tabs>li.active",rule:{color:"#000",borderBottom:"none"}},
{selector:".h5devtool .tab-content",rule:{marginTop:"-1px",width:"100%",height:"100%",paddingBottom:"30px","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box","*position":"absolute","*height":"auto","*top":"26px","*left":0,"*bottom":0,"*right":"20px","*paddingBottom":0,"*overflow-y":"auto","*overflow-x":"hidden"}},{selector:".h5devtool .tab-content>*",rule:{overflow:"auto","float":"left",height:"inherit",width:"100%",paddingLeft:0,margin:0,height:"100%","-moz-box-sizing":"border-box",
"-webkit-box-sizing":"border-box",boxSizing:"border-box"}},{selector:".h5devtool .tab-content>*.hasfix",rule:{overflow:"visible!important"}},{selector:".h5devtool .tab-content>*",rule:{display:"none"}},{selector:".h5devtool .tab-content>.active",rule:{display:"block"}},{selector:".h5devtool .dropdown-menu",rule:{position:" absolute",top:"100%",left:"0","z-index":"1000",display:"none","float":"left","min-width":"160px",padding:"5px 0",margin:"2px 0 0","list-style":"none","background-color":"#fff",
border:"1px solid #ccc",border:"1px solid rgba(0,0,0,0.2)","-webkit-border-radius":"6px","-moz-border-radius":"6px","border-radius":"6px","-webkit-box-shadow":"0 5px 10px rgba(0,0,0,0.2)","-moz-box-shadow":"0 5px 10px rgba(0,0,0,0.2)","box-shadow":"0 5px 10px rgba(0,0,0,0.2)","-webkit-background-clip":"padding-box","-moz-background-clip":"padding","background-clip":"padding-box"}},{selector:".h5devtool .dropdown-menu li",rule:{fontSize:"0.8em",padding:"8px",cursor:"pointer"}},{selector:".h5devtool .dropdown-menu li:hover",
rule:{backgroundColor:"#eee"}}],ka={selector:".h5devtool .trace-list>li",rule:{lineHeight:"2em"}},la={},ma=[{selector:".h5devtool-overlay, .h5devtool-overlay *",rule:{position:"absolute",zIndex:1E4,"-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box"}},{selector:".h5devtool-overlay .body",rule:{height:"100%",width:"100%",opacity:"0.2",filter:"alpha(opacity=20)",backgroundColor:"rgb(64, 214, 255)"}},{selector:".h5devtool-overlay.event-target .body",rule:{backgroundColor:"rgb(128,255,198)"}},
{selector:".h5devtool-overlay .border",rule:{opacity:"0.3",filter:"alpha(opacity=30)",position:"absolute",borderTopWidth:"3px",borderLeftWidth:"3px",borderBottomWidth:0,borderRightWidth:0}},{selector:".h5devtool-overlay.root .border",rule:{borderStyle:"solid",borderColor:"rgb(64, 214, 255)"}},{selector:".h5devtool-overlay.child .border",rule:{borderStyle:"dashed",borderColor:"rgb(64, 214, 255)"}},{selector:".h5devtool-overlay.event-target .border",rule:{borderStyle:"dashed",borderColor:"rgb(128,255,198)"}},
{selector:".h5devtool-overlay.borderOnly .body",rule:{display:"none"}},{selector:".h5devtool-overlay.borderOnly",rule:{height:"0!important",width:"0!important"}}],h=h5.core.view.createView();h.register("wrapper",'<div class="h5devtool-upper-right"><div class="h5devtool-controllBtn showhideBtn hideTool">↑</div><div class="h5devtool-controllBtn opencloseBtn closeTool">×</div></div><div class="h5devtool posfix" style="position:fix; left:0; top:0;"></div>');h.register("devtool-tab",'<div class="devtool-tab"><ul class="nav nav-tabs root-nav"><li class="active" data-tab-page="controller-info">コントローラ</li><li data-tab-page="logic-info">ロジック</li><li data-tab-page="trace">トレース</li><li data-tab-page="logger">ロガー</li><li data-tab-page="settings">設定</li></ul><div class="tab-content"><div class="active controller-info target-info columnLayoutWrapper"></div><div class="logic-info target-info columnLayoutWrapper"></div><div class="trace hasfix"></div><div class="logger hasfix"></div><div class="settings"></div></div>');
h.register("targetListInfoWrapper",'<div class="left ovfAuto"></div><div class="right ovfHidden"></div>');h.register("target-list",'<ul class="targetlist"></ul>');h.register("target-list-part",'<li><span class="target-name [%= cls %]">[%= name %]</span></li>');h.register("method-list",'<div class="fixedControlls"><select class="method-select"></select></div><ul class="liststyle-none no-padding method-list floating-list">[% for(var i = 0, l = methods.length; i < l; i++){ var p = methods[i];%]<li class="[%= (methodCount.get(p)?"called":"nocalled") %]"><span class="name">[%= p %]</span><span class="count">[%= methodCount.get(p) %]</span><pre class="value">[%= _funcToStr(defObj[p]) %]</pre></li>[% } %]</ul>');
h.register("trace",'<div class="fixedControlls"><label class="event eventColor filterLabel"><input type="checkbox" checked name="event"/>イベント</label><label class="public publicColor filterLabel"><input type="checkbox" checked name="public" />パブリック</label><label class="private privateColor filterLabel"><input type="checkbox" checked name="private" />プライベート</label><label class="lifecycle lifecycleColor filterLabel"><input type="checkbox" checked name="lifecycle"/>ライフサイクル</label><span class="log logColor filterLabel"><label><input type="checkbox" checked name="log"/>ログ</label><select class="logLevelThreshold"><option value="50">ERROR</option><option value="40">WARN</option><option value="30">INFO</option><option value="20" selected>DEBUG</option><option value="10">TRACE</option></select></span><button class="clearAllLogs">ログをクリア</button><br><input type="text" class="filter"/><button class="filter-show">絞込み</button><button class="filter-hide">除外</button><button class="filter-clear" disabled>フィルタ解除</button><span class="font-small">（ログを右クリックまたはタッチで関数にジャンプ）</span></div><ul class="trace-list liststyle-none no-padding floating-list" data-h5-loop-context="logs"></ul><ul class="contextMenu logContextMenu dropdown-menu"><li class="showFunction"><span>関数を表示</span></li></ul>');
h.register("trace-log-part",'<li class="[%= cls %] logLine"><span class="time">[%= time %]</span><span style="margin-left:[%= indentWidth %]px" class="tag">[%= tag %]:</span><span class="promiseState">[%= promiseState %]</span><span class="message [%= cls %] [%= cls %]Color">[%= message %]</span></li>');h.register("logger-log-part",'<li class=" logger-log log logLine [%= levelString %]"><span class="time">[%= time %]</span>[[%= levelString %]] [%= message %] </li>');h.register("logger",'<div class="fixedControlls">フィルタ：<select class="logLevelThreshold"><option value="50">ERROR</option><option value="40">WARN</option><option value="30">INFO</option><option value="20" selected>DEBUG</option><option value="10">TRACE</option></select><button class="clearAllLogs">ログをクリア</button></div><ul class="liststyle-none no-padding floating-list console"></ul>');
h.register("controller-detail",'<div class="detail instance-detail controller-detail"><ul class="nav nav-tabs"><li class="active" data-tab-page="eventHandler">イベントハンドラ</li><li data-tab-page="method">メソッド</li><li data-tab-page="trace">トレース</li><li data-tab-page="otherInfo">その他情報</li></ul><div class="tab-content"><div class="active eventHandler hasfix"></div><div class="method hasfix"></div><div class="trace hasfix"></div><div class="otherInfo"></div></div>');h.register("eventHandler-list",'<div class="fixedControlls">[% if(eventHandlers.length){ %]<select class="method-select"></select></div><ul class="liststyle-none no-padding method-list floating-list">[% for(var i = 0, l = eventHandlers.length; i < l; i++){ var p = eventHandlers[i]; %]<li class="[%= (methodCount.get(p)?"called":"nocalled") %]"><span class="menu">ターゲット:<select class="eventTarget"></select><button class="trigger">実行</button></span><span class="name">[%= p %]</span><span class="count">[%= methodCount.get(p) %]</span><pre class="value">[%= _funcToStr(controller[p]) %]</pre></li>[% } %]</ul>[% } else { %]<p>なし</p>[% } %]');
h.register("controller-otherInfo",'<dl><dt>名前</dt><dd>[%= controller.__name %]</dd><dt> ルートコントローラか</dt><dd>[%= controller.__controllerContext.isRoot %]</dd><dt>ルート要素</dt><dd>[%= _formatDOM(controller.rootElement)  %]</dd><dt>ルートコントローラ</dt><dd>[%= controller.rootController.__name %]</dd><dt>親コントローラ</dt><dd>[%= controller.parentController && controller.parentController.__name || "なし" %]</dd><dt>子コントローラ一覧</dt><dd>[% if(!childControllerNames.length){ %]なし[% }else{ %]<ul class="no-padding">[% for(var i = 0, l = childControllerNames.length; i < l; i++){ %]<li>[%= childControllerNames[i] %]</li>[% } %]</ul>[% } %]</dd><dt>テンプレートパス一覧</dt><dd>[% if(!controller.__templates){ %]なし[% }else{ %]<ul class="no-padding">[% var templates = typeof controller.__templates === "string"? [controller.__templates]: controller.__templates; for(var i = 0, l = templates.length; i < l; i++){ %]<li>[%= templates[i] %]</li>[% } %]</ul>[% } %]</dd><dt>このコントローラで登録されたテンプレートID一覧</dt><dd>[% if(registedTemplates.length === 0){ %]なし[% }else{ %][%= registedTemplates.join(", ") %][% } %]</dd><dt>利用可能なテンプレートID一覧</dt><dd>[% if(availableTemplates.length === 0){ %]なし[% }else{ %][%= availableTemplates.join(", ") %][% } %]</dd></dl>');
h.register("logic-detail",'<div class="detail instance-detail logic-detail"><ul class="nav nav-tabs"><li class="active" data-tab-page="method">メソッド</li><li data-tab-page="trace">トレース</li><li data-tab-page="otherInfo">その他情報</li></ul><div class="tab-content"><div class="active method hasfix"></div><div class="trace hasfix"></div><div class="otherInfo"></div></div>');h.register("logic-otherInfo","<dl><dt>名前</dt><dd>[%= defObj.__name %]</dd><dt>ロジックインスタンスの名前</dt><dd>[%= instanceName %]</dd></dl>");h.register("overlay",
'<div class="h5devtool-overlay [%= cls %]"><div class="body"></div><div class="border top"></div><div class="border right"></div><div class="border bottom"></div><div class="border left"></div></div>');h.register("settings",'<label for="h5devtool-setting-LogMaxNum">ログの最大表示件数</label><input type="text" id="h5devtool-setting-LogMaxNum" data-h5-bind="attr(value):LogMaxNum" name="LogMaxNum"/><button class="set">設定</button>');var P=h5.log.createLogger("h5.devtool"),s=null,M=!1,w=h5.core.data.createObservableItem({LogMaxNum:{type:"integer",
defaultValue:1E3,constraint:{notNull:!0,min:0}}}),y=[],N=x(),E=0,t=x(),J=function(){},W="",r={target:"h5.devtool.dummyController",pointCut:"f",interceptors:J};O(r);h5.settings.aspects=[r];h5.core.controller(document,{__name:"h5.devtool.dummyController",f:function(){}}).initPromise.done(function(){W=this.f.toString();this.dispose()});h5.settings.aspects=null;var X=!h5.env.ua.isIE||!/(^2\..*)|(^1\.8|9|(10)\..*)/.test(e().jquery),z={};e.extend(D.prototype,{count:function(a){var b=++this._method[a].count;
this._callback&&this._callback(a);return b},get:function(a){return this._method[a].count},registerCallback:function(a){this._callback=a},removeCallback:function(){this._callback=null}});h5.core.expose({__name:"h5.devtool.ui.ContextMenuController",_contextMenu:null,contextMenuExp:"",targetAll:!0,__construct:function(a){a.args&&(void 0!=a.args.targetAll&&(this.targetAll=a.args.targetAll),void 0!=a.args.contextMenuExp&&(this.contextMenuExp=a.args.contextMenuExp))},__ready:function(a){var b=e(this.rootElement),
c=b.attr("data-targetall");void 0!=c&&(/false/i.test(c)&&(c=!1),this.targetAll=!!c);void 0!=b.attr("data-contextmenuexp")&&(this.contextMenuExp=a.args.contextMenuExp);this.close()},_getContextMenu:function(a){return this.$find("> .contextMenu"+(a||this.contextMenuExp))},close:function(a){var b=this.$find("> .contextMenu");b.hasClass("open")&&(this.trigger("selectMenuItem",{selected:a?a:null}),b.css({display:"none"}),b.removeClass("open"),this.trigger("hideCustomMenu"))},_open:function(a,b){function c(a,
b,d){a.find("> .dropdown-submenu > .dropdown-menu").each(function(){var a=e(this),g,f=a[0].style.display;a.css({display:"block"});g=a.outerWidth(!0);g>r-b?(a.parent().addClass("pull-left"),g=b-g):(a.parent().removeClass("pull-left"),g=b+g);var k=a.parent(),l=d+k.position().top,h=a.outerHeight(!0);h>t-l?(l=l-h+k.height(),a.css({top:"auto",bottom:"0"})):a.css({top:"0",bottom:"auto"});c(a,g,l);a.css({display:f})})}function d(a){var b="CSS1Compat"!==document.compatMode?document.body:document.documentElement;
return h5.env.ua.isiOS?window["inner"+a]:b["client"+a]}function g(a){var b="CSS1Compat"!==document.compatMode;return function(){var c=b?document.body:document.documentElement;return window["page"+("Top"===a?"Y":"X")+"Offset"]||c["scroll"+a]}}var k=this._getContextMenu(b);if(k.hasClass("open")||!this.trigger("showCustomMenu",{orgContext:a}).isDefaultPrevented()){k.css({display:"block",visibility:"hidden",left:0,top:0});k.addClass("open");var f,l;a.event.originalEvent.targetTouches?(l=a.event.originalEvent.targetTouches[0],
f=l.pageX,l=l.pageY):(f=a.event.pageX,l=a.event.pageY);var h=ha(k),h=e(h).offset();f-=h.left;l-=h.top;var h=ga(k),m=fa(k),H=g("Left")(),n=g("Top")(),q=d("Width"),s=d("Height"),r=H+q,t=n+s,q=f+h;q>r&&(f=r-h,f<H&&(f=H));l+m>t&&(l-=m,l<n&&(l=n));c(k,q,l);k.css({visibility:"visible",left:f,top:l})}},_filter:null,setFilter:function(a){null==a?this._filter=null:e.isFunction(a)?this._filter=a:"string"===typeof a&&(this._filter=function(b){if(e(b.event.target).filter(a).length)return!1})},".trace-list>li>* touchstart":function(a){this._contextmenu(a)},
"{rootElement} contextmenu":function(a){this._contextmenu(a)},"{document.body} click":function(a){this.close()},"{document.body} contextmenu":function(a){this.close()},".contextMenuBtn contextmenu":function(a){a.event.preventDefault();a.event.stopPropagation();var b=e(a.event.currentTarget).attr("data-contextmenuexp");this._open(a,b)},"> .contextMenu .dropdown-menu click":function(a){a.event.stopPropagation();this.close()},"> .contextMenu li a click":function(a){a.event.stopPropagation();this.close(a.event.target)},
_contextmenu:function(a){this.close();this._filter&&!1===this._filter(a)||!this.targetAll||(a.event.preventDefault(),a.event.stopPropagation(),this._open(a))}});h5.core.expose({__name:"h5.devtool.ControllerAndLogicInfoController",win:null,$info:null,selectedTarget:null,_methodCountMap:{},__init:function(){if(!this.__controllerContext.controllerDef)for(var a=h5.core.controllerManager.getAllControllers(),b=0,c=a.length;b<c;b++)V(a[b],a[b])},__ready:function(a){this.win=a.args.win;S(this.win,h5.env.ua.isDesktop?
$:$.concat(ka),la);S(window,ma);h.append(this.$find(".left"),"target-list");this.$find(".right>.detail").css("display","none");a=h5.core.controllerManager.getAllControllers();for(var b=0,c=a.length;b<c;b++)this.appendTargetToList(a[b])},"{.h5devtool} close":function(){this.removeOverlay(!0)},"{.h5devtool} leftclick":function(){this.unfocus()},"{window.opener.document} h5controllerunbound":function(a){this.removeTargetList(a.evArg)},".targetlist .target-name mouseover":function(a,b){var c=this.getTargetFromElem(b);
this.removeOverlay();c.__name&&c.__controllerContext&&b.data("h5devtool-overlay",this.overlay(c.rootElement,c.__controllerContext.isRoot?"root":"child"))},".targetlist .target-name mouseout":function(a,b){this.removeOverlay()},".targetlist .target-name click":function(a,b){if(!b.hasClass("selected")){var c=this.getTargetFromElem(b);this.$find(".target-name").removeClass("selected");b.addClass("selected");this.setTarget(c);if(c=b.data("h5devtool-overlay"))this.removeOverlay(!0,c),e(".h5devtool-overlay").addClass("borderOnly")}},
setTarget:function(a){this.selectedTarget=a;this.setDetail(a)}," .eventHandler li:not(.selected) mouseover":function(a,b){this.selectEventHandler(b)},".eventHandler li:not(.selected) click":function(a,b){this.selectEventHandler(b)}," .eventHandler li.selected mouseleave":function(a,b){this.selectEventHandler(null)},selectEventHandler:function(a){this.$find(".eventHandler li").removeClass("selected");this.removeOverlay();if(null!=a){a.addClass("selected");var b=this.getTargetFromElem(this.$find(".target-name.selected")),
c=e.trim(a.find(".name").text()),b=da(c,b);a.data("h5devtool-eventTarget",b);this.overlay(b,"event-target");var d=a.closest("li").find("select.eventTarget").html("");b.length?b.each(function(){var a=e(s.document.createElement("option"));a.data("h5devtool-eventTarget",this);a.text(T(this));d.append(a)}):(a=e(s.document.createElement("option")),a.text("該当なし"),d.append(a),d.attr("disabled","disabled"))}}," .eventHandler .trigger click":function(a,b){var c=e.trim(b.closest("li").find(".name").text()).match(/ (\S+)$/)[1],
d=b.closest(".menu").find("option:selected").data("h5devtool-eventTarget");d?e(d).trigger(c):alert("イベントターゲットがありません")},".method-select change":function(a,b){var c=b.val(),d=b.parents(".active").eq(0).find(".method-list");Z(d,c,!0)},"{.h5devtool} tabChange":function(a){"eventHandler"!==a.evArg&&(this.removeOverlay(),this.$find(".eventHandler li").removeClass("selected"))},_clearDetailView:function(){for(var a=h5.core.controllerManager.getControllers(this.$find(".right"),{deep:!0}),b=0,c=a.length;b<
c;b++)a[b].dispose();this.$find(".right").html("")},setDetail:function(a){this._clearDetailView();if(null!=a){var b=n(a);b.methodCount._method||(b.methodCount._method=new D(a));a.__controllerContext?this._showControllerDetail(a):this._showLogicDetail(a)}},_showControllerDetail:function(a){h.update(this.$find(".right"),"controller-detail");var b=[],c=[],d=n(a),g;for(g in d.methodCount._method)-1===g.indexOf(" ")?b.push(g):c.push(g);b.sort(function(a,b){if(-1!==e.inArray(a,q)&&-1!==e.inArray(b,q))return e.inArray(a,
q)-e.inArray(b,q);var c;c=0-(0<=e.inArray(a,q)?1:0);c+=0<=e.inArray(b,q)?1:0;c-=h5.u.str.startsWith(a,"_")&&-1===e.inArray(a,q)?-1:0;c+=h5.u.str.startsWith(b,"_")&&-1===e.inArray(b,q)?-1:0;return 0===c?a>b?1:-1:c});this._updateEventHandlerView({id:d.id,controller:a.__controllerContext.controllerDef,eventHandlers:c,_funcToStr:I,methodCount:d.methodCount});this._updateMethodView({id:d.id,defObj:a.__controllerContext.controllerDef,methods:b,_funcToStr:I,methodCount:d.methodCount});b=d.devtoolLog;h5.core.controller(this.$find(".instance-detail .trace"),
h5.devtool.TraceLogController,{traceLogs:b,loggerArray:t,infoCtrls:[this]});for(var c=U(a),b=[],d=0,k=c.length;d<k;d++)b.push(a[c[d]].__name);c=[];for(g in a.view.__view.__cachedTemplates)-1===e.inArray(g,c)&&c.push(g);for(var d=[],k=a,f=k.view.__view;;){var l=f.__cachedTemplates;for(g in l)-1===e.inArray(g,d)&&d.push(g);if(f===h5.core.view)break;k.parentController?(k=k.parentController,f=k.view.__view):f=h5.core.view}h.update(this.$find(".instance-detail .tab-content .otherInfo"),"controller-otherInfo",
{controller:a,childControllerNames:b,_formatDOM:T,availableTemplates:d,registedTemplates:c})},_updateEventHandlerView:function(a){var b=this.$find(".instance-detail .tab-content .eventHandler");h.update(b,"eventHandler-list",a);for(var c=b.find(".method-select"),d=0,g=a.eventHandlers.length;d<g;d++)c.append(h5.u.str.format('<option value="{0}">{0}</option>',a.eventHandlers[d]));var k=this._methodCountMap,f=a.id;b.find(".method-list>*").each(function(){var a=e(this);k[f+"#"+a.find(".name").text()]=
a.find(".count")});this._registerMethodCountCallback(z[a.id],a.methodCount)},_updateMethodView:function(a){var b=this.$find(".instance-detail .tab-content .method");h.update(b,"method-list",a);for(var c=b.find(".method-select"),d=0,g=a.methods.length;d<g;d++)c.append(h5.u.str.format('<option value="{0}">{0}</option>',a.methods[d]));var k=this._methodCountMap,f=a.id;b.find(".method-list>*").each(function(){var a=e(this);k[f+"#"+a.find(".name").text()]=a.find(".count")});this._registerMethodCountCallback(z[a.id],
a.methodCount)},".detail>.nav-tabs>.active click":function(a,b){if("method"===b.data("tab-page")||"eventHandler"===b.data("tab-page")){var c=this.getTargetFromElem(this.$find(".target-name.selected"));this.setDetail(c)}},_showLogicDetail:function(a){h.update(this.$find(".right"),"logic-detail");var b=[],c=[],d;for(d in a.__logicContext.logicDef)e.isFunction(a.__logicContext.logicDef[d])&&(h5.u.str.startsWith(d,"_")?b.push(d):c.push(d));b.sort();c.sort();c=c.concat(b);b=n(a);d=this.$find(".instance-detail .tab-content .method");
this._updateMethodView({id:b.id,defObj:a.__logicContext.logicDef,methods:c,_funcToStr:I,methodCount:b.methodCount});var g=this._methodCountMap,k=b.id;d.find(".method-list>*").each(function(){var a=e(this);g[k+"#"+a.find(".name").text()]=a.find(".count")});this._registerMethodCountCallback(a,b.methodCount);c=b.devtoolLog;h5.core.controller(this.$find(".instance-detail .trace"),h5.devtool.TraceLogController,{traceLogs:c,loggerArray:t,infoCtrls:[this]});h.update(this.$find(".instance-detail .tab-content .otherInfo"),
"logic-otherInfo",{defObj:a.__logicContext.logicDef,instanceName:b.instanceName||"なし(このインスタンスがルートロジックです)"})},_registerMethodCountCallback:function(a,b){b.registerCallback(this.own(function(c){if(a.__name&&this.selectedTarget===a){var d=n(a).id,d=this._methodCountMap[d+"#"+c];d.text(b.get(c));d.parent().addClass("called")}}))},setTargetToElem:function(a,b){e(a).data("h5devtool-targetId",n(b).id)},getTargetFromElem:function(a){a=e(a).data("h5devtool-targetId");return z[a]},unfocus:function(){this.setDetail(null);
this.$find(".target-name").removeClass("selected");this.removeOverlay(!0)},overlay:function(a,b){var c=(e.isArray(b)?b:[b]).join(" "),d=e(a),g=e();d.each(function(){var a=e(h.get("overlay",{cls:c})),b=e(this).outerWidth(),d=e(this).outerHeight(),p=e(this).offset()||{top:0,left:0};a.css({width:b,height:d,top:p.top,left:p.left});var p=a.find(".border.top"),m=a.find(".border.right"),n=a.find(".border.bottom"),q=a.find(".border.left");p.css({top:0,left:0,width:b,height:3});m.css({top:0,left:b,width:3,
height:d});n.css({top:d,left:0,width:b,height:3});q.css({top:0,left:0,width:3,height:d});e(window.document.body).append(a);g=g.add(a)});return g},removeOverlay:function(a,b){var c=a?e(".h5devtool-overlay"):e(".h5devtool-overlay:not(.borderOnly)");(b?c.not(b):c).remove()},appendTargetToList:function(a,b){if(!h5.u.str.startsWith(a.__name,"h5.devtool")){var c=n(a),d=a.__name+"_"+(new Date).getTime()+"_"+parseInt(1E3*Math.random());z[d]=a;n(a).id=d;b=b||this.$find(".targetlist:first");c.devtoolLog||(c.devtoolLog=
x());c.methodCount=c.methodCount||new D(a);if(a.__controllerContext){if(c=e(h.get("target-list-part",{name:a.__name,cls:a.__controllerContext.isRoot?"root":"child"}),b[0].ownerDocument),this.setTargetToElem(c.children(".target-name"),a),b.append(c),d=U(a),d.length)for(var g=0,k=d.length;g<k;g++){var f=d[g],l=a[f];l.__controllerContext.devtool=l.__controllerContext.devtool||{};l.__controllerContext.devtool.instanceName=a.__name+"#"+f;h.append(c,"target-list");this.appendTargetToList(l,c.find("ul:last"))}}else a.__logicContext.devtool=
a.__logicContext.devtool||{name:a.__name,devtoolLog:x()},c=e(h.get("target-list-part",{name:a.__name,cls:"root"}),b[0].ownerDocument),this.setTargetToElem(c.children(".target-name"),a),b.append(c);d=!1;for(f in a)h5.u.str.endsWith(f,"Logic")&&a[f]&&!e.isFunction(a[f])&&(d||(h.append(c,"target-list"),d=!0),a[f].__logicContext.devtool=a[f].__logicContext.devtool||{},a[f].__logicContext.devtool.instanceName=a.__name+"#"+f,this.appendTargetToList(a[f],c.find("ul:last")))}},removeTargetList:function(a){var b=
this.$find(".selected");a===this.getTargetFromElem(b)&&this.unfocus();var c=this;this.$find(".targetlist .target-name").each(function(){if(c.getTargetFromElem(this)===a)return e(this).closest("li").remove(),!1});ja(n(a).id)}});h5.core.expose({__name:"h5.devtool.SettingsController",__ready:function(){h.bind(this.rootElement,w);w.addEventListener("change",function(a){for(var b in a.props){var c=a.props[b].newValue;switch(b){case "LogMaxNum":for(var d=0,e=y.length;d<e;d++)c>=y[d].length||y[d].splice(0,
y[d].length-c)}}})},".set click":function(){var a={};this.$find("input").each(function(){a[this.name]=this.value});w.validate(a)?s.alert("ログの最大表示件数は0以上の整数値で入力してください"):w.set(a)}});r={__name:"h5.devtool.BaseLogController",_contextMenuController:h5.devtool.ui.ContextMenuController,__meta:{_contextMenuController:{inheritArgs:!0}},_isScrollLast:!1,_logArray:null,_createLogHTML:function(){},_selectLogObject:null,__ready:function(a){this._contextMenuController.contextMenuExp=".logContextMenu";this._contextMenuController.setFilter("*:not(.trace-list>li>*)")},
setLogArray:function(a,b){a._viewBindTarget=b;this._logArray=a;a.addEventListener("logUpdate",this.own(this._update));this._logArray.length&&this._updateView();e(b).bind("scroll",this.ownWithOrg(function(a,b){this._isScrollLast=a.scrollTop>a.scrollHeight-a.clientHeight-30}))},setCreateLogHTML:function(a){this._createLogHTML=a},clear:function(){this._logArray&&this._logArray.copyFrom(null)},_update:function(){if(e(this.rootElement).hasClass("active")){var a=this._logArray;a._logUpdatedInMaxDelay=!0;
a._logDelayTimer&&clearTimeout(a._logDelayTimer);a._logDelayTimer=setTimeout(this.own(function(){this._updateView()}),100)}},_updateView:function(){if(this.__name){var a=this._logArray;clearTimeout(a._logDelayTimer);clearTimeout(a._logMaxDelayTimer);a._logDelayTimer=null;a._logMaxDelayTimer=null;var b=a._viewBindTarget;b&&(b.innerHTML=this._createLogHTML(a));this._isScrollLast&&(b.scrollTop=b.scrollHeight-b.clientHeight);a._logUpdatedInMaxDelay=!1;a._logMaxDelayTimer=setTimeout(this.own(function(){a._logUpdatedInMaxDelay&&
this._updateView()}),500)}},"{rootElement} tabSelect":function(){this._updateView()},"{rootElement} showCustomMenu":function(a){this._unselect();a=e(a.evArg.orgContext.event.target).closest("li");a.addClass("selected");this._selectLogObject=this._logArray.get(a.attr("data-h5devtool-logindex"))},"{rootElement} hideCustomMenu":function(a){this._unselect()},_unselect:function(){this.$find(".trace-list>li").removeClass("selected")},".showFunction click":function(a,b){for(var c=this._selectLogObject.target,
d=this.parentController.infoCtrls,g=null,k=!1,f=0,h=d.length;f<h&&!k;f++){var p=d[f];p.$find(".target-name").each(function(){if(p.getTargetFromElem(this)===c)return e(this).trigger("mouseover"),e(this).trigger("click"),k=!0,g=p,!1})}if(g){e(g.rootElement).hasClass("controller-info")?e(s.document.body).find(".root-nav").find('*[data-tab-page="controller-info"]').trigger("click"):e(g.rootElement).hasClass("logic-info")&&e(s.document.body).find(".root-nav").find('*[data-tab-page="logic-info"]').trigger("click");
var m=this._selectLogObject.message;setTimeout(function(){var a=e.trim(m.slice(m.indexOf("#")+1)),b=-1!==a.indexOf(" ")&&c.__controllerContext?"eventHandler":"method",d=g.$find('.instance-detail>.nav-tabs>*[data-tab-page="'+b+'"]');d.hasClass("active")||d.trigger("click");b=g.$find(".instance-detail ."+b+" .method-list");Z(b,a,!0)},0)}}};h5.core.expose(r);h5.core.expose({__name:"h5.devtool.TraceLogController",_condition:{filterStr:"",exclude:!1,hideCls:{}},baseController:r,infoCtrls:[],_traceLogArray:null,
_loggerArray:null,_loggerArrayUpdateListener:null,__meta:{baseController:{inheritArgs:!0}},__ready:function(a){h.update(this.rootElement,"trace");this.baseController.setCreateLogHTML(this.own(this._createLogHTML));this._traceLogArray=a.args.traceLogs;this._loggerArray=a.args.loggerArray;this.baseController.setLogArray(a.args.traceLogs,this.$find(".trace-list")[0]);a.args.infoCtrls&&this.setInfoControllers(a.args.infoCtrls);a=0;for(var b=this._loggerArray.length;a<b;a++)-1===this._traceLogArray.indexOf(this._loggerArray.get(a))&&
this._traceLogArray.push(this._loggerArray.get(a));this._traceLogArray.sort(function(a,b){return a.timeStamp-b.timeStamp});this._loggerArrayUpdateListener=this.own(this._loggerArrayUpdate);this._loggerArray.addEventListener("logUpdate",this._loggerArrayUpdateListener)},setInfoControllers:function(a){this.infoCtrls=a},_loggerArrayUpdate:function(){var a=this._loggerArray,b=this._traceLogArray;b.push(a.get(a.length-1));b.dispatchEvent({type:"logUpdate"})},_createLogHTML:function(a){for(var b=this._condition.filterStr,
c=this._condition.filterReg,d=this._condition.filterStr&&this._condition.exclude,g=this._condition.hideCls,k=this.$find(".logLevelThreshold").val(),f="",l=0,p=a.length;l<p;l++){var m=a.get(l),n="",n=m.tag?h.get("trace-log-part",m):h.get("logger-log-part",m),n=e(n).attr("data-h5devtool-logindex",l)[0].outerHTML,q=m.message?m.message:h5.u.str.format.apply(h5.u.str,m.args);!d===!(c?m.message.match(c):-1!==q.indexOf(b))?f+=e(n).css("display","none")[0].outerHTML:(g&&g[m.cls]?n=e(n).css("display","none")[0].outerHTML:
m.levelString&&(g&&g.log||m.level<k)&&(n=e(n).css("display","none")[0].outerHTML),f+=n)}return f},'input[type="checkbox"] change':function(a,b){var c=b.attr("name");b.prop("checked")?this._condition.hideCls[c]=!1:this._condition.hideCls[c]=!0;"log"===c&&b.parent().find("select").prop("disabled",!b.prop("checked"));this.refresh()},".logLevelThreshold change":function(a,b){this.refresh()},"input.filter keydown":function(a){13===a.event.keyCode&&(a=this.$find("input.filter").val())&&this._executeFilter(a)},
"input.filter keyup":function(a){""===this.$find("input.filter").val()&&this._executeFilter("")},"button.filter-show click":function(a){if(a=this.$find("input.filter").val())this._executeFilter(a),this.$find(".filter-clear").prop("disabled")},"button.filter-hide click":function(a){if(a=this.$find("input.filter").val())this._executeFilter(a,!0),this.$find(".filter-clear").prop("disabled")},"button.filter-clear click":function(a){this._executeFilter("");this.$find(".filter-clear").prop("disabled",!0)},
"button.clearAllLogs click":function(a){this.clear()},_executeFilter:function(a,b){this.$find(".filter-clear").prop("disabled",!a);this._condition.filterStr=a;this._condition.filterReg=-1!==a.indexOf("*")?F(a):null;this._condition.exclude=!!b;this.refresh()},refresh:function(){this.$find(".trace-list")[0].innerHTML=this._createLogHTML(this.baseController._logArray)},clear:function(){this.baseController.clear();this.$find(".trace-list")[0].innerHTML=""},__unbind:function(){this._loggerArray.removeEventListener("logUpdate",
this._loggerArrayUpdateListener)}});h5.core.expose({__name:"h5.devtool.LoggerController",baseController:h5.devtool.BaseLogController,_logArray:null,__meta:{baseController:{inheritArgs:!0}},__init:function(){h.append(this.rootElement,"logger")},__ready:function(a){this.baseController.setCreateLogHTML(this.own(this._createLogHTML));this.baseController.setLogArray(a.args.loggerArray,this.$find(".console")[0]);this._onnerrorHandler=this.own(function(a){var c=a.originalEvent.message,d=a.originalEvent.fileName||
"";a=a.originalEvent.lineno||"";var e=new Date;t.push({levelString:"EXCEPTION",level:50,time:C(e),timeStamp:e.getTime(),message:h5.u.str.format("{0} {1}:{2}",c,d,a)});t.dispatchEvent({type:"logUpdate"})});e(window).bind("error",this._onnerrorHandler)},".logLevelThreshold change":function(a,b){this.refresh()},".clearAllLogs click":function(){this.baseController.clear();this.$find(".console")[0].innerHTML=""},refresh:function(){this.$find(".console")[0].innerHTML=this._createLogHTML(this.baseController._logArray)},
_createLogHTML:function(a){for(var b=this.$find(".logLevelThreshold").val(),c="",d=0,g=a.length;d<g;d++){var k=a.get(d),f=h.get("logger-log-part",k);k.level<b&&(f=e(f).css("display","none")[0].outerHTML);c+=f}return c},__unbind:function(){e(window).unbind("error",this._onnerrorHandler)}});h5.core.expose({__name:"h5.devtool.TabController",__ready:function(){this.$find("tab-content").not(".active").css("display","none")},selectTab:function(a){this.$find(".nav-tabs li."+a).trigger("click")},".nav-tabs li click":function(a,
b){if(!b.hasClass("active")){b.parent().find(">.active").removeClass("active");b.addClass("active");var c=b.data("tab-page"),d=b.closest(".nav-tabs").next();d.find(">.active").removeClass("active");d=d.find(">."+c);d.addClass("active");this.trigger("tabChange",c);d.trigger("tabSelect")}}});var aa={__name:"h5.devtool.DevtoolController",win:null,targetWindow:window,_controllerInfoController:h5.devtool.ControllerAndLogicInfoController,_logicInfoController:h5.devtool.ControllerAndLogicInfoController,
_tabController:h5.devtool.TabController,_traceLogController:h5.devtool.TraceLogController,_loggerController:h5.devtool.LoggerController,_settingsController:h5.devtool.SettingsController,__meta:{_controllerInfoController:{inheritArgs:!0},_logicInfoController:{inheritArgs:!0},_traceLogController:{inheritArgs:!0},_settingsController:{inheritArgs:!0},_loggerController:{inheritArgs:!0}},_boundLogics:[],_logicboundEventBound:!1,__construct:function(a){this.win=a.args.win;h.append(this.rootElement,"devtool-tab");
h.append(this.$find(".controller-info"),"targetListInfoWrapper");h.append(this.$find(".logic-info"),"targetListInfoWrapper");h.append(this.$find(".settings"),"settings");this.__meta._controllerInfoController.rootElement=this.$find(".controller-info");this.__meta._logicInfoController.rootElement=this.$find(".logic-info");this.__meta._traceLogController.rootElement=this.$find(".trace");this.__meta._loggerController.rootElement=this.$find(".logger");this.__meta._settingsController.rootElement=this.$find(".settings");
h5.settings.log={target:{view:{type:{log:function(a){var b=a.args;if(!b[1]||"string"!==typeof b[1]||0!==b[1].indexOf("h5.devtool.")){for(var b=a.levelString,c=b.length;5>c;c++)b+=" ";t.push({levelString:b,level:a.level,time:C(a.date),timeStamp:a.date.getTime(),message:h5.u.str.format.apply(h5.u.str,a.args)});t.dispatchEvent({type:"logUpdate"})}}}}},out:[{category:"*",targets:["view"]}]};h5.log.configure();var b=h5.core.logic,c=this;h5.core.logic=function(a){a=b(a);c._logicboundEventBound?e(window.document).trigger("h5devtoolLogicbound",
a):c._boundLogics.push(a);return a}},__ready:function(){for(var a=this._boundLogics,b=0,c=a.length;b<c;b++)this._logicInfoController.appendTargetToList(a[b]);this._logicboundEventBound=!0;this._traceLogController.setInfoControllers([this._controllerInfoController,this._logicInfoController])},"{this.targetWindow.document} h5devtoolLogicbound":function(a){this._logicInfoController.appendTargetToList(a.evArg)},"{this.targetWindow.document} h5controllerbound":function(a){a.evArg.__name&&this._controllerInfoController.appendTargetToList(a.evArg)},
"{this.targetWindow.document} h5controllerunbound":function(a){this._controllerInfoController.removeTargetList(a.evArg)},"{document} keydown":function(a){116===a.event.keyCode&&B&&a.event.preventDefault()},".left click":function(a,b){a.event.target===b[0]&&this.trigger("leftclick")},"{.h5devtool-controllBtn.opencloseBtn.closeTool} click":function(a,b){b.text("▼").removeClass("closeTool").addClass("openTool");e(".h5devtool-controllBtn").not(b).css("display","none");e(this.rootElement).css("display",
"none");this.trigger("close")},"{.h5devtool-controllBtn.opencloseBtn.openTool} click":function(a,b){b.text("×").removeClass("openTool").addClass("closeTool");e(".h5devtool-controllBtn").not(b).css("display","inline-block");e(this.rootElement).css("display","block");e(".h5devtool-controllBtn.showhideBtn.showTool").trigger("click");this.trigger("open")},"{.h5devtool-controllBtn.showhideBtn.hideTool} click":function(a,b){b.text("↓").removeClass("hideTool").addClass("showTool");B||e(this.rootElement).css({display:"none"})},
"{.h5devtool-controllBtn.showhideBtn.showTool} click":function(a,b){b.text("↑").removeClass("showTool").addClass("hideTool");B||e(this.rootElement).css({display:""})}};h5.core.expose(aa);P.info("hifive Developer Tool(ver.{0})の読み込みが完了しました。",Q);var A=null,u=null,r={target:"*",interceptors:h5.u.createInterceptor(function(a,b){var c=a.target;if(M||!c.__name||h5.u.str.startsWith(c.__name,"h5.devtool"))return a.proceed();var d=a.funcName,g=n(c);g.indentLevel=g.indentLevel||0;var k=g.methodCount;k||(k=new D(c),
g.methodCount=k);k.count(d);var k=g.indentLevel,f="",f=-1!==d.indexOf(" ")&&c.__controllerContext?"event":-1!==e.inArray(d,q)&&c.__controllerContext?"lifecycle":0===d.indexOf("_")?"private":"public";b.beginLog=[];g.devtoolLog||(g.devtoolLog=x());if(A&&A!==c&&u){var h=K(c,c.__name+"#"+d,f,"BEGIN","",u.indentLevel);v(u.devtoolLog,h);u.indentLevel+=1;b.beginLog.push({target:A,logObj:h})}h=K(c,d,f,"BEGIN","",k);b.logObj=h;v(g.devtoolLog,h);g.indentLevel+=1;b.beginLog.push({target:c,logObj:h});d=K(c,c.__name+
"#"+d,f,"BEGIN","",E);E++;v(N,d);b.wholeLog=d;A=c;u=g;return a.proceed()},function(a,b){var c=a.target;if(!M&&c.__name&&!h5.u.str.startsWith(c.__name,"h5.devtool")){c=n(c);c.indentLevel=c.indentLevel||0;var d=a.result,c=d&&e.isFunction(d.promise)&&!h5.u.obj.isJQueryObject(d)&&e.isFunction(d.done)&&e.isFunction(d.fail),g="",h="END";c&&(h="DFD","resolved"===d.state()?g="(RESOLVED)":"rejected"===d.state()&&(g="(REJECTED)"));d=C(new Date);if(b.beginLog)for(var f=0,l=b.beginLog.length;f<l;f++){var p=b.beginLog[f].target,
m=e.extend({},b.beginLog[f].logObj);m.tag=h;m.promiseState=g;m.time=d;m.indentWidth=c?0:m.indentWidth;v(n(p).devtoolLog,m);n(p).indentLevel-=1}f=e.extend({},b.wholeLog);f.tag=h;f.promiseState=g;f.time=d;f.indentWidth=c?0:f.indentWidth;v(N,f);E-=1;u=A=null}}),pointCut:"*"};O(r);h5.settings.aspects=[r];e(function(){G().done(function(a){s=a;h5.core.controller(e(a.document).find(".h5devtool"),aa,{win:a,traceLogs:N,loggerArray:t}).readyPromise.done(function(){var b=this;Y(a,"unload",function(){b._controllerInfoController.removeOverlay(!0);
b.dispose();M=!0});a!=window&&Y(window,"unload",function(){a.close()})})}).fail(function(a){"block"===a&&alert("[hifive Developer Tool]\n別ウィンドウのオープンに失敗しました。ポップアップブロックを設定している場合は一時的に解除してください。")})})}})(jQuery);